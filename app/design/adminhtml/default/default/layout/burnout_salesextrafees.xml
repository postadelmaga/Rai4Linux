<?xml version="1.0"?>

<layout>
    <!-- ORDER CREATE -->
    <HANDLE_ORDER_CREATE_SHIPPING_INSURANCE>
        <reference name="shipping_method">
            <block type="burnout_salesExtraFees/adminhtml_sales_order_create_shippingInsurance"/>
        </reference>
    </HANDLE_ORDER_CREATE_SHIPPING_INSURANCE>
    <HANDLE_ORDER_CREATE_WARRANTY>
        <reference name="items_grid">
            <action method="setTemplate">
                <value>burnout_salesextrafees/sales/order/create/items/grid.phtml</value>
            </action>
        </reference>
    </HANDLE_ORDER_CREATE_WARRANTY>

    <adminhtml_sales_order_create_index>
        <reference name="head">
            <action method="addJs">
                <file>burnout_salesextrafees/adminhtml/sales.js</file>
            </action>
        </reference>
        <update handle="HANDLE_ORDER_CREATE_WARRANTY"/>
        <update handle="HANDLE_ORDER_CREATE_SHIPPING_INSURANCE"/>
    </adminhtml_sales_order_create_index>

    <adminhtml_sales_order_create_load_block_data>
        <update handle="HANDLE_ORDER_CREATE_WARRANTY"/>
        <update handle="HANDLE_ORDER_CREATE_SHIPPING_INSURANCE"/>
    </adminhtml_sales_order_create_load_block_data>

    <adminhtml_sales_order_create_load_block_shipping_method>
        <update handle="HANDLE_ORDER_CREATE_SHIPPING_INSURANCE"/>
    </adminhtml_sales_order_create_load_block_shipping_method>

    <adminhtml_sales_order_create_load_block_items>
        <update handle="HANDLE_ORDER_CREATE_WARRANTY"/>
    </adminhtml_sales_order_create_load_block_items>

    <!-- ORDER VIEW -->
    <adminhtml_sales_order_view>
        <reference name="order_totals">
            <block name="warranty_fee" type="burnout_salesExtraFees/order_totals_extendedWarranty" before="tax"/>
            <block name="shipping_insurance_fee" type="burnout_salesExtraFees/order_totals_shippingInsurance"
                   before="tax"/>
        </reference>
        <reference name="order_items">
            <action method="addItemRender">
                <type>default</type>
                <block>adminhtml/sales_order_view_items_renderer_default</block>
                <template>burnout_salesextrafees/sales/order/view/items/renderer/default.phtml</template>
            </action>
        </reference>
    </adminhtml_sales_order_view>

    <!-- INVOICE -->
    <HANDLE_EXTRA_FEE_INVOICE>
        <reference name="invoice_totals">
            <block name="warranty_fee" type="burnout_salesExtraFees/invoice_totals_extendedWarranty" before="tax"/>
            <block name="shipping_insurance_fee" type="burnout_salesExtraFees/invoice_totals_shippingInsurance"
                   before="tax"/>
        </reference>
    </HANDLE_EXTRA_FEE_INVOICE>

    <adminhtml_sales_order_invoice_new>
        <update handle="HANDLE_EXTRA_FEE_INVOICE"/>
    </adminhtml_sales_order_invoice_new>
    <adminhtml_sales_order_invoice_updateqty>
        <update handle="HANDLE_EXTRA_FEE_INVOICE"/>
    </adminhtml_sales_order_invoice_updateqty>
    <adminhtml_sales_order_invoice_view>
        <update handle="HANDLE_EXTRA_FEE_INVOICE"/>
    </adminhtml_sales_order_invoice_view>
    <adminhtml_sales_order_invoice_print>
        <update handle="HANDLE_EXTRA_FEE_INVOICE"/>
    </adminhtml_sales_order_invoice_print>
    <adminhtml_sales_order_invoice_email>
        <update handle="HANDLE_EXTRA_FEE_INVOICE"/>
    </adminhtml_sales_order_invoice_email>


    <!-- CREDIT MEMO -->
    <HANDLE_EXTRA_FEE_CREDIT_CREATE>
        <reference name="creditmemo_totals">
            <block name="adjustments_shipping_insurance" type="burnout_salesExtraFees/adminhtml_sales_order_creditmemo_create_totals_shippingInsurance"/>
            <block name="adjustments_warranty" type="burnout_salesExtraFees/adminhtml_sales_order_creditmemo_create_totals_extendedWarranty"/>
        </reference>
    </HANDLE_EXTRA_FEE_CREDIT_CREATE>

    <adminhtml_sales_order_creditmemo_new>
        <update handle="HANDLE_EXTRA_FEE_CREDIT_CREATE"/>
    </adminhtml_sales_order_creditmemo_new>

    <adminhtml_sales_order_creditmemo_updateqty>
        <update handle="HANDLE_EXTRA_FEE_CREDIT_CREATE"/>
    </adminhtml_sales_order_creditmemo_updateqty>

    <adminhtml_sales_order_creditmemo_view>
        <reference name="creditmemo_totals">
            <block name="adjustments_shipping_insurance" type="burnout_salesExtraFees/adminhtml_sales_order_creditmemo_view_totals_shippingInsurance"/>
            <block name="adjustments_warranty" type="burnout_salesExtraFees/adminhtml_sales_order_creditmemo_view_totals_extendedWarranty"/>
        </reference>
    </adminhtml_sales_order_creditmemo_view>

</layout>